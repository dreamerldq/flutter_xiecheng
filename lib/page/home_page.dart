import 'package:flutter/material.dart';import 'package:flutter_app/dao/home_dao.dart';import 'package:flutter_app/model/common_model.dart';import 'package:flutter_app/model/grid_nav_model.dart';import 'package:flutter_app/model/home_model.dart';import 'package:flutter_app/model/sales_box_model.dart';import 'package:flutter_swiper/flutter_swiper.dart';import 'package:flutter_app/widget/grid_nav.dart';import 'package:flutter_app/widget/local_nav.dart';import 'package:flutter_app/widget/sub_nav.dart';import 'package:flutter_app/widget/sales_box.dart';class HomePage extends StatefulWidget{  @override  _HomePage createState() {    // TODO: implement createState    return _HomePage();  }}class _HomePage extends State<HomePage>{  List _imageList = [    'https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1564989295715&di=d3851e3373375cbc994d4f6ea0477c86&imgtype=0&src=http%3A%2F%2F5b0988e595225.cdn.sohucs.com%2Fimages%2F20181129%2Feaee0b8f428f4fdbb3e1ee96de57ac6f.jpeg',    'https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1565584038&di=023908080fc70bab755877123e4126ac&imgtype=jpg&er=1&src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201411%2F16%2F20141116124947_xBNxM.jpeg',    'https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1565584066&di=abacbbc63b98476bc82c466b7bb96aa4&imgtype=jpg&er=1&src=http%3A%2F%2Fpic67.nipic.com%2Ffile%2F20150515%2F9448607_221818217002_2.jpg'  ];  double appBarAloha = 0;  String resultString = "";  List<CommonModel> localNavList = [];  List<CommonModel> subNavList = [];  SalesBoxModel salesBoxModel;  GridNavModel gridNavModel;  @override  void initState(){    super.initState();    loadData();  }  _onScroll(offset){    double alpha = offset / 200;        if(alpha < 0){          alpha = 0;        }else if(alpha > 1){          alpha = 1;        }        setState(() {          appBarAloha = alpha;        });        print(appBarAloha);  }  loadData() async{   try{     HomeModel model = await HomeDao.fetch();     setState(() {      resultString = '请求成功';      gridNavModel = model.gridNav;      localNavList = model.localNavList;      subNavList = model.subNavList;      salesBoxModel = model.salesBox;     });   }catch(e){      setState(() {        resultString = e.toString();      });   }  }  @override  Widget build(BuildContext context) {    // TODO: implement build    return Scaffold(      backgroundColor: Color(0xfff2f2f2),      body: Stack(        children: <Widget>[          MediaQuery.removePadding(              context: context,              removeTop: true,              child: NotificationListener(                onNotification: (scrollNotification){                  if(scrollNotification is ScrollUpdateNotification && scrollNotification.depth == 0){                    _onScroll(scrollNotification.metrics.pixels);                  }                },                child: ListView(                  children: <Widget>[                    Container(                        height: 160,                        child:   Swiper(                          itemCount : _imageList.length,                          autoplay: true,                          itemBuilder: (BuildContext context, int index){                            return Image.network(_imageList[index], fit: BoxFit.fill,);                          },                          pagination: SwiperPagination(),                        )                    ),                    Padding(                      child:   LocalNav(localNavList: localNavList),                      padding: EdgeInsets.fromLTRB(7, 4, 7, 4 ),                    ),                   Padding(                     child:  GridNav(gridNavModel: gridNavModel),                     padding: EdgeInsets.fromLTRB(7, 0, 7, 4 ),                   ),                    Padding(                      child:  SubNav(subNavList: subNavList),                      padding: EdgeInsets.fromLTRB(7, 0, 7, 4 ),                    ),                    Padding(                      child:  SalesBox(salesBox: salesBoxModel),                      padding: EdgeInsets.fromLTRB(7, 0, 7, 4 ),                    ),                    Container(                      height: 800,                      child:  ListTile(title: Text(resultString)),                    )                  ],                ),)          ),          Opacity(            opacity: appBarAloha,            child: Container(              height: 80,              decoration: BoxDecoration(color: Colors.white),              child: Center(                child: Padding(padding: EdgeInsets.only(top: 20),                  child: Text('首页'),                ),              ),            ),          )        ],      )    );  }}